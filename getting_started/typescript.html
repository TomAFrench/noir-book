<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js ayu">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>TypeScript - The Noir Programming Language</title>
                

        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

                <link rel="icon" href="../favicon.svg">
                        <link rel="shortcut icon" href="../favicon.png">
                <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
                <link rel="stylesheet" href="../css/print.css" media="print">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="../fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
                <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "ayu";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('ayu')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../index.html">The Noir Programming Language</a></li><li class="chapter-item expanded "><a href="../getting_started.html"><strong aria-hidden="true">1.</strong> Getting Started</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../getting_started/nargo.html"><strong aria-hidden="true">1.1.</strong> Nargo</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../getting_started/nargo/installation.html"><strong aria-hidden="true">1.1.1.</strong> Installation</a></li><li class="chapter-item expanded "><a href="../getting_started/nargo/commands.html"><strong aria-hidden="true">1.1.2.</strong> Commands</a></li></ol></li><li class="chapter-item expanded "><a href="../getting_started/hello_world.html"><strong aria-hidden="true">1.2.</strong> Hello, World</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../getting_started/breakdown.html"><strong aria-hidden="true">1.2.1.</strong> Breakdown</a></li></ol></li><li class="chapter-item expanded "><a href="../getting_started/solidity_verifier.html"><strong aria-hidden="true">1.3.</strong> Solidity Verifier</a></li><li class="chapter-item expanded "><a href="../getting_started/typescript.html" class="active"><strong aria-hidden="true">1.4.</strong> TypeScript</a></li><li class="chapter-item expanded "><a href="../getting_started/merkle-proof.html"><strong aria-hidden="true">1.5.</strong> Merkle Proof</a></li></ol></li><li class="chapter-item expanded "><a href="../language_concepts.html"><strong aria-hidden="true">2.</strong> Language Concepts</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../language_concepts/mutability.html"><strong aria-hidden="true">2.1.</strong> Mutability</a></li><li class="chapter-item expanded "><a href="../language_concepts/data_types.html"><strong aria-hidden="true">2.2.</strong> Data Types</a></li><li class="chapter-item expanded "><a href="../language_concepts/functions.html"><strong aria-hidden="true">2.3.</strong> Functions</a></li><li class="chapter-item expanded "><a href="../language_concepts/comments.html"><strong aria-hidden="true">2.4.</strong> Comments</a></li><li class="chapter-item expanded "><a href="../language_concepts/control_flow.html"><strong aria-hidden="true">2.5.</strong> Control Flow</a></li><li class="chapter-item expanded "><a href="../language_concepts/ops.html"><strong aria-hidden="true">2.6.</strong> Operations</a></li><li class="chapter-item expanded "><a href="../language_concepts/constrain.html"><strong aria-hidden="true">2.7.</strong> Constrain Statement</a></li></ol></li><li class="chapter-item expanded "><a href="../modules_packages_crates.html"><strong aria-hidden="true">3.</strong> Modules, Packages, Crates</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../modules_packages_crates/crate.html"><strong aria-hidden="true">3.1.</strong> Crate</a></li><li class="chapter-item expanded "><a href="../modules_packages_crates/packages.html"><strong aria-hidden="true">3.2.</strong> Packages</a></li><li class="chapter-item expanded "><a href="../modules_packages_crates/modules.html"><strong aria-hidden="true">3.3.</strong> Modules</a></li><li class="chapter-item expanded "><a href="../modules_packages_crates/dependencies.html"><strong aria-hidden="true">3.4.</strong> Dependencies</a></li></ol></li><li class="chapter-item expanded "><a href="../acir.html"><strong aria-hidden="true">4.</strong> ACIR</a></li><li class="chapter-item expanded "><a href="../c_overview.html"><strong aria-hidden="true">5.</strong> Compilation Overview</a></li><li class="chapter-item expanded "><a href="../coming_soon.html"><strong aria-hidden="true">6.</strong> Coming!</a></li><li class="chapter-item expanded "><a href="../license.html"><strong aria-hidden="true">7.</strong> LICENSE</a></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu (default)</button></li>
                        </ul>
                                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                                            </div>

                    <h1 class="menu-title">The Noir Programming Language</h1>

                    <div class="right-buttons">
                                                <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                                                                        
                    </div>
                </div>

                                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="typescript"><a class="header" href="#typescript">TypeScript</a></h1>
<p>Interactions with Noir programs can also be performed in TypeScript, which can come in handy when writing tests or when working in TypeScript-based projects like <a href="https://hardhat.org/">Hardhat</a>.</p>
<p>The following sections use the <a href="https://github.com/vezenovm/basic_mul_noir_example"><em>Standard Noir Example</em></a> as an example to dissect a typical Noir workflow in TypeScript, with specific focus on its:</p>
<ul>
<li>Test script <a href="https://github.com/vezenovm/basic_mul_noir_example/blob/master/test/1_mul.ts"><code>1_mul.ts</code></a></li>
<li>Noir program <a href="https://github.com/vezenovm/basic_mul_noir_example/blob/master/circuits/src/main.nr"><code>main.nr</code></a></li>
<li>Verifier contract generator script <a href="https://github.com/vezenovm/basic_mul_noir_example/blob/master/scripts/generate_sol_verifier.ts"><code>generate_sol_verifier.ts</code></a></li>
</ul>
<p>You are also welcome to revisit the full scripts <a href="https://github.com/vezenovm/basic_mul_noir_example/blob/master/test/1_mul.ts"><code>1_mul.ts</code></a> of <em>Standard Noir Example</em> and <a href="https://github.com/vezenovm/mastermind-noir/blob/master/test/mm.ts"><code>mm.ts</code></a> of <em>Mastermind in Noir</em> anytime for inspirations.</p>
<h2 id="setup"><a class="header" href="#setup">Setup</a></h2>
<p>Install <a href="https://classic.yarnpkg.com/lang/en/docs/install/">Yarn</a> and <a href="https://nodejs.org/en/download/">Node.js</a>.</p>
<p>Install Noir dependencies in your project by running:</p>
<pre><code class="language-bash">$ yarn add @noir-lang/noir_wasm @noir-lang/barretenberg @noir-lang/aztec_backend
</code></pre>
<p>And import the applicable functions into your TypeScript file by adding:</p>
<pre><code class="language-ts">// 1_mul.ts
import { compile, acir_from_bytes } from '@noir-lang/noir_wasm';
import { setup_generic_prover_and_verifier, create_proof, verify_proof, create_proof_with_witness } from '@noir-lang/barretenberg/dest/client_proofs';
import { packed_witness_to_witness, serialise_public_inputs, compute_witnesses } from '@noir-lang/aztec_backend';
</code></pre>
<h2 id="compiling"><a class="header" href="#compiling">Compiling</a></h2>
<p>To begin proving and verifying a Noir program, it first needs to be compiled by calling <code>noir_wasm</code>'s <code>compile</code> function:</p>
<pre><code class="language-ts">// 1_mul.ts
const compiled_program = compile(path.resolve(__dirname, &quot;../circuits/src/main.nr&quot;));
</code></pre>
<p>The <code>compiled_program</code> returned by the function contains the <a href="../acir.html">ACIR</a> and the Application Binary Interface (ABI) of your Noir program. They shall be stored for proving your program later:</p>
<pre><code class="language-ts">// 1_mul.ts
let acir = compiled_program.circuit;
const abi = compiled_program.abi;
</code></pre>
<blockquote>
<p><strong>Note:</strong> Compiling with <code>noir_wasm</code> may lack some of the newer features that <code>nargo compile</code> offers. See the <a href="#proving-and-verifying-externally-compiled-files">Proving and Verifying Externally Compiled Files</a> section to learn more.</p>
</blockquote>
<h2 id="specifying-inputs"><a class="header" href="#specifying-inputs">Specifying Inputs</a></h2>
<p>Having obtained the compiled program, the program inputs shall then be specified in its ABI.</p>
<p><em>Standard Noir Example</em> is a program that multiplies input <code>x</code> with input <code>y</code> and returns the result:</p>
<pre><code class="language-noir"># main.nr
fn main(x: u32, y: pub u32) -&gt; pub u32 {
    let z = x * y;
    z
}
</code></pre>
<p>Hence, one valid scenario for proving could be <code>x = 3</code>, <code>y = 4</code> and <code>return = 12</code>:</p>
<pre><code class="language-ts">// 1_mul.ts
abi.x = 3;
abi.y = 4;
abi.return = 12;
</code></pre>
<blockquote>
<p><strong>Info:</strong> Return values are also required to be specified, as they are merely syntax sugar of inputs with equality constraints.</p>
</blockquote>
<blockquote>
<p><strong>Tip:</strong> To best protect the private inputs in your program (if applicable) from public knowledge, you should consider minimizing any passing around of inputs and deleting the inputs on the prover instance once the proof is created when designing your program.</p>
</blockquote>
<h2 id="initializing-prover--verifier"><a class="header" href="#initializing-prover--verifier">Initializing Prover &amp; Verifier</a></h2>
<p>Prior to proving and verifying, the prover and verifier have to first be initialized by calling <code>barretenberg</code>'s <code>setup_generic_prover_and_verifier</code> with your Noir program's ACIR:</p>
<pre><code class="language-ts">// 1_mul.ts
let [prover, verifier] = await setup_generic_prover_and_verifier(acir);
</code></pre>
<h2 id="proving"><a class="header" href="#proving">Proving</a></h2>
<p>The Noir program can then be executed and proved by calling <code>barretenberg</code>'s <code>create_proof</code> function:</p>
<pre><code class="language-ts">// 1_mul.ts
const proof = await create_proof(prover, acir, abi);
</code></pre>
<h2 id="verifying"><a class="header" href="#verifying">Verifying</a></h2>
<p>The <code>proof</code> obtained can be verified by calling <code>barretenberg</code>'s <code>verify_proof</code> function:</p>
<pre><code class="language-ts">// 1_mul.ts
const verified = await verify_proof(verifier, proof);
</code></pre>
<p>The function should return <code>true</code> if the entire process is working as intended, which can be asserted if you are writing a test script:</p>
<pre><code class="language-ts">// 1_mul.ts
expect(verified).eq(true);
</code></pre>
<h2 id="verifying-with-smart-contract"><a class="header" href="#verifying-with-smart-contract">Verifying with Smart Contract</a></h2>
<p>Alternatively, a verifier smart contract can be generated and used for verifying Noir proofs in TypeScript as well.</p>
<p>This could be useful if the Noir program is designed to be decentrally verified and/or make use of decentralized states and logics that is handled at the smart contract level.</p>
<p>To generate the verifier smart contract:</p>
<pre><code class="language-ts">// generate_sol_verifier.ts

// Imports
import { writeFileSync } from 'fs';

...

// Generate verifier contract
const sc = verifier.SmartContract();
syncWriteFile(&quot;../contracts/plonk_vk.sol&quot;, sc);

...

function syncWriteFile(filename: string, data: any) {
    writeFileSync(join(__dirname, filename), data, {
      flag: 'w',
    });
}
</code></pre>
<p>To verify a Noir proof using the verifier contract:</p>
<pre><code class="language-ts">// 1_mul.ts

// Imports
import { ethers } from &quot;hardhat&quot;;
import { Contract, ContractFactory, utils } from 'ethers';

...

// Deploy verifier contract
let Verifier: ContractFactory;
let verifierContract: Contract;

before(async () =&gt; {
    Verifier = await ethers.getContractFactory(&quot;TurboVerifier&quot;);
    verifierContract = await Verifier.deploy();
});

...

// Verify proof
const sc_verified = await verifierContract.verify(proof);
expect(sc_verified).eq(true)
</code></pre>
<h2 id="proving-and-verifying-externally-compiled-files"><a class="header" href="#proving-and-verifying-externally-compiled-files">Proving and Verifying Externally Compiled Files</a></h2>
<p>In some cases, <code>noir_wasm</code> may lack some of the newer features for compiling Noir programs due to separated upgrade workflows.</p>
<p>To benefit from the best of both worlds, a Noir program can be compiled with <code>nargo compile</code>, with the <code>.acir</code> and <code>.tr</code> files then passed into your TypeScript project for proving and verifying:</p>
<pre><code class="language-ts">// 1_mul.ts

// Parse acir
let acirByteArray = path_to_uint8array(path.resolve(__dirname, '../circuits/build/p.acir'));
let acir = acir_from_bytes(acirByteArray);

// Parse witness
let witnessByteArray = path_to_uint8array(path.resolve(__dirname, '../circuits/build/p.tr'));
const barretenberg_witness_arr = await packed_witness_to_witness(acir, witnessByteArray);

...

// Create proof
const proof = await create_proof_with_witness(prover, barretenberg_witness_arr);
</code></pre>
<blockquote>
<p><strong>Info:</strong> The <code>.acir</code> file is the ACIR of your Noir program, and the <code>.tr</code> file is the witness file. The witness file can be considered as program inputs parsed for your program's ACIR.</p>
</blockquote>
<p>See the <a href="nargo/commands.html#nargo-compile-circuit_name">Commands</a> section to learn more about the <code>nargo compile</code> command.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                                                    <a rel="prev" href="../getting_started/solidity_verifier.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        
                                                    <a rel="next" href="../getting_started/merkle-proof.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                                    <a rel="prev" href="../getting_started/solidity_verifier.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                
                                    <a rel="next" href="../getting_started/merkle-proof.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                            </nav>

        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
        
                <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        
    </body>
</html>
